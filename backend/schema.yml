openapi: 3.0.3
info:
  title: RxVerify Lite API
  version: 1.0.0
  description: Cryptographic Medicine Verification System - A pharmaceutical supply
    chain verification platform using digital signatures and blockchain-inspired trust
    scoring.
paths:
  /api/auth/token/:
    post:
      operationId: auth_token_create
      description: |-
        Takes a set of user credentials and returns an access and refresh JSON web
        token pair to prove the authentication of those credentials.
      tags:
      - auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TokenObtainPairRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/TokenObtainPairRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/TokenObtainPairRequest'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenObtainPair'
          description: ''
  /api/auth/token/refresh/:
    post:
      operationId: auth_token_refresh_create
      description: |-
        Takes a refresh type JSON web token and returns an access type JSON web
        token if the refresh token is valid.
      tags:
      - auth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TokenRefreshRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/TokenRefreshRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/TokenRefreshRequest'
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenRefresh'
          description: ''
  /api/distributors/:
    get:
      operationId: distributors_list
      description: Retrieve a paginated list of pharmaceutical distributors with verification
        status filtering.
      summary: List all distributors
      parameters:
      - name: ordering
        required: false
        in: query
        description: Which field to use when ordering the results.
        schema:
          type: string
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      - name: search
        required: false
        in: query
        description: A search term.
        schema:
          type: string
      - in: query
        name: verified
        schema:
          type: boolean
        description: Filter by regulatory verification status
        examples:
          VerifiedOnly:
            value: 'true'
            summary: Verified Only
          UnverifiedOnly:
            value: 'false'
            summary: Unverified Only
      tags:
      - Distributors
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedDistributorList'
          description: ''
    post:
      operationId: distributors_create
      description: "\n        Register a new pharmaceutical distributor with Ed25519\
        \ public key.\n        \n        **Public Key Format:**\n        - Must be\
        \ 64 hexadecimal characters (0-9, a-f)\n        - Represents Ed25519 public\
        \ key for signature verification\n        - Generated off-server by distributor's\
        \ private key\n        - Used to verify lot manifest signatures\n        \n\
        \        **Requires admin role.**\n        "
      summary: Create new distributor
      tags:
      - Distributors
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DistributorRequest'
            examples:
              NewDistributor:
                value:
                  name: HealthDist Kenya Ltd
                  public_key: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
                  is_verified_regulator: false
                summary: New Distributor
              VerifiedDistributor:
                value:
                  name: PharmaCorp East Africa
                  public_key: bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
                  is_verified_regulator: true
                summary: Verified Distributor
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/DistributorRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/DistributorRequest'
        required: true
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Distributor'
          description: ''
  /api/distributors/{id}/:
    get:
      operationId: distributors_retrieve
      description: Get detailed information about a specific distributor including
        verification status and public key.
      summary: Retrieve distributor details
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Distributor.
        required: true
      tags:
      - Distributors
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Distributor'
          description: ''
    put:
      operationId: distributors_update
      description: Update all fields of an existing distributor. Requires admin role.
      summary: Update distributor
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Distributor.
        required: true
      tags:
      - Distributors
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DistributorRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/DistributorRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/DistributorRequest'
        required: true
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Distributor'
          description: ''
    patch:
      operationId: distributors_partial_update
      description: Update specific fields of a distributor. Requires admin role.
      summary: Partially update distributor
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Distributor.
        required: true
      tags:
      - Distributors
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedDistributorRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/PatchedDistributorRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/PatchedDistributorRequest'
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Distributor'
          description: ''
    delete:
      operationId: distributors_destroy
      description: Permanently delete a distributor from the system. Requires admin
        role.
      summary: Delete distributor
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Distributor.
        required: true
      tags:
      - Distributors
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '204':
          description: No response body
  /api/flags/:
    get:
      operationId: flags_list
      description: Retrieve quality reports with comprehensive filtering options including
        severity level.
      summary: List all crowd flags
      parameters:
      - in: query
        name: issue_type
        schema:
          type: string
        description: Filter by issue type (case-insensitive)
        examples:
          Counterfeits:
            value: Counterfeit Suspected
          QualityIssues:
            value: Quality Issue
            summary: Quality Issues
      - in: query
        name: lot
        schema:
          type: string
          format: uuid
        description: Filter by lot manifest ID
      - in: query
        name: my_flags
        schema:
          type: boolean
        description: Show only flags created by current user
        examples:
          MyFlagsOnly:
            value: 'true'
            summary: My Flags Only
      - name: ordering
        required: false
        in: query
        description: Which field to use when ordering the results.
        schema:
          type: string
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      - in: query
        name: reporter_type
        schema:
          type: string
        description: Filter by reporter type
      - in: query
        name: resolved
        schema:
          type: boolean
        description: Filter by resolution status
        examples:
          UnresolvedOnly:
            value: 'false'
            summary: Unresolved Only
          ResolvedOnly:
            value: 'true'
            summary: Resolved Only
      - name: search
        required: false
        in: query
        description: A search term.
        schema:
          type: string
      - in: query
        name: severity
        schema:
          type: string
        description: Filter by severity level (impacts trust score)
        examples:
          CriticalIssues:
            value: CRITICAL
            summary: Critical Issues
          HighPriority:
            value: HIGH
            summary: High Priority
          MediumPriority:
            value: MEDIUM
            summary: Medium Priority
          LowPriority:
            value: LOW
            summary: Low Priority
      tags:
      - Flags
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedCrowdFlagList'
          description: ''
    post:
      operationId: flags_create
      description: "\n        Submit a quality report with severity categorization.\n\
        \        \n        **Severity Levels & Trust Score Impact:**\n        - CRITICAL:\
        \ -15.00 points (counterfeits, safety hazards)\n        - HIGH: -10.00 points\
        \ (significant quality issues)\n        - MEDIUM: -5.00 points (notable concerns)\
        \ [DEFAULT]\n        - LOW: -2.00 points (minor issues)\n        \n      \
        \  **Auto-Populated Fields:**\n        - `user`: Automatically set to authenticated\
        \ user (DO NOT include!)\n        - `created_at`: Auto-timestamp\n       \
        \ - `is_resolved`: Defaults to false\n        \n        **Side Effect:**\n\
        \        ⚠️ Automatically decreases lot trust_score in REAL-TIME based on\
        \ severity!\n        \n        **DO NOT include** the `user` field in your\
        \ request!\n        "
      summary: Create new crowd flag
      tags:
      - Flags
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CrowdFlagRequest'
            examples:
              Critical-CounterfeitSuspected:
                value:
                  reporter_type: Pharmacist
                  issue_type: Counterfeit Suspected
                  severity: CRITICAL
                  description: Fake hologram detected, packaging differs from authentic
                    batches. Seal appears professionally resealed.
                  lot: 494466b3-0f94-4f5c-8a12-38e403fcf3e7
                summary: Critical - Counterfeit Suspected
              High-QualityIssue:
                value:
                  reporter_type: Pharmacist
                  issue_type: Quality Issue
                  severity: HIGH
                  description: Tablets are discolored and crumbling. Unusual odor
                    detected.
                  lot: 494466b3-0f94-4f5c-8a12-38e403fcf3e7
                summary: High - Quality Issue
              Medium-PackagingDamage:
                value:
                  reporter_type: Patient
                  issue_type: Packaging Damage
                  severity: MEDIUM
                  description: Seal appears tampered with, but contents seem intact.
                  lot: 494466b3-0f94-4f5c-8a12-38e403fcf3e7
                summary: Medium - Packaging Damage
              Low-MinorIssue:
                value:
                  reporter_type: Patient
                  issue_type: Minor Issue
                  severity: LOW
                  description: Label slightly faded but still readable. No quality
                    concerns.
                  lot: 494466b3-0f94-4f5c-8a12-38e403fcf3e7
                summary: Low - Minor Issue
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/CrowdFlagRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/CrowdFlagRequest'
        required: true
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CrowdFlag'
          description: ''
  /api/flags/{id}/:
    get:
      operationId: flags_retrieve
      description: Get detailed information about a specific quality report including
        severity and resolution status.
      summary: Retrieve crowd flag details
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Crowd Flag.
        required: true
      tags:
      - Flags
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CrowdFlag'
          description: ''
    put:
      operationId: flags_update
      description: Update all fields of an existing quality report.
      summary: Update crowd flag
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Crowd Flag.
        required: true
      tags:
      - Flags
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CrowdFlagRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/CrowdFlagRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/CrowdFlagRequest'
        required: true
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CrowdFlag'
          description: ''
    patch:
      operationId: flags_partial_update
      description: Update specific fields of a quality report.
      summary: Partially update crowd flag
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Crowd Flag.
        required: true
      tags:
      - Flags
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedCrowdFlagRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/PatchedCrowdFlagRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/PatchedCrowdFlagRequest'
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CrowdFlag'
          description: ''
    delete:
      operationId: flags_destroy
      description: Permanently delete a quality report from the system.
      summary: Delete crowd flag
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Crowd Flag.
        required: true
      tags:
      - Flags
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '204':
          description: No response body
  /api/flags/{id}/resolve/:
    post:
      operationId: flags_resolve_create
      description: "\n        Mark a quality report as resolved after investigation.\n\
        \        \n        **Side Effect:**\n        ⚠️ Automatically recalculates\
        \ lot trust_score in REAL-TIME!\n        The trust score will INCREASE as\
        \ this flag is no longer counted in penalties.\n        \n        **No request\
        \ body required** - Just POST to this endpoint.\n        \n        Typically\
        \ used by administrators after investigation.\n        "
      summary: Mark flag as resolved
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Crowd Flag.
        required: true
      tags:
      - Flags
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CrowdFlagRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/CrowdFlagRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/CrowdFlagRequest'
        required: true
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CrowdFlag'
          description: ''
  /api/flags/{id}/unresolve/:
    post:
      operationId: flags_unresolve_create
      description: "\n        Mark a quality report as unresolved (reopen a resolved\
        \ issue).\n        \n        **Side Effect:**\n        ⚠️ Automatically recalculates\
        \ lot trust_score in REAL-TIME!\n        The trust score will DECREASE as\
        \ this flag is now counted in penalties again.\n        \n        **No request\
        \ body required** - Just POST to this endpoint.\n        \n        Used to\
        \ reopen resolved issues if new information emerges.\n        "
      summary: Mark flag as unresolved
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Crowd Flag.
        required: true
      tags:
      - Flags
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CrowdFlagRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/CrowdFlagRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/CrowdFlagRequest'
        required: true
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CrowdFlag'
          description: ''
  /api/manifests/:
    get:
      operationId: manifests_list
      description: Retrieve a paginated list of lot manifests with filtering options.
      summary: List all lot manifests
      parameters:
      - name: ordering
        required: false
        in: query
        description: Which field to use when ordering the results.
        schema:
          type: string
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      - name: search
        required: false
        in: query
        description: A search term.
        schema:
          type: string
      tags:
      - Manifests
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedLotManifestList'
          description: ''
    post:
      operationId: manifests_create
      description: "\n        Register a new lot/batch manifest with **auto-generated**\
        \ Ed25519 digital signature.\n        \n        **Auto-Generated Fields:**\n\
        \        - `digital_signature`: Ed25519 signature (128 hex chars)\n      \
        \    * Signed message: batch_number:expiry_date:distributor_id\n         \
        \ * Auto-generated using derived signing key\n        - `trust_score`: Automatically\
        \ set to 100.00 (IMMUTABLE)\n        \n        **Required Fields:**\n    \
        \    - `batch_number`: Unique lot/batch identifier\n        - `expiry_date`:\
        \ Medicine expiration date (YYYY-MM-DD)\n        - `medicine`: Medicine UUID\n\
        \        - `distributor`: Distributor UUID\n        \n        **DO NOT provide**\
        \ `digital_signature` or `trust_score` - they are auto-generated and immutable!\n\
        \        \n        Requires admin role.\n        "
      summary: Create new lot manifest
      tags:
      - Manifests
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LotManifestRequest'
            examples:
              ParacetamolLot:
                value:
                  batch_number: PCM-2026-KE-00142
                  expiry_date: '2028-11-15'
                  medicine: f9e8d7c6-b5a4-4321-9876-fedcba098765
                  distributor: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
                summary: Paracetamol Lot
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/LotManifestRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/LotManifestRequest'
        required: true
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LotManifest'
          description: ''
  /api/manifests/{id}/:
    get:
      operationId: manifests_retrieve
      description: Get detailed information about a specific lot manifest including
        digital signature and trust score.
      summary: Retrieve lot manifest details
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Lot Manifest.
        required: true
      tags:
      - Manifests
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LotManifest'
          description: ''
    put:
      operationId: manifests_update
      description: "\n        Update lot manifest fields with AUTOMATIC signature\
        \ regeneration.\n        \n        **Updatable Fields:**\n        - `batch_number`:\
        \ Lot/batch identifier\n        - `expiry_date`: Medicine expiration date\n\
        \        - `medicine`: Medicine UUID\n        - `distributor`: Distributor\
        \ UUID\n        \n        **IMMUTABLE Fields (Auto-Managed):**\n        -\
        \ `digital_signature`: ALWAYS auto-regenerated after update\n        - `trust_score`:\
        \ CANNOT be changed (locked at 100.00)\n        \n        **Behavior:**\n\
        \        - Any update will regenerate the digital signature\n        - trust_score\
        \ is ignored if provided\n        \n        Requires admin role.\n        "
      summary: Update lot manifest
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Lot Manifest.
        required: true
      tags:
      - Manifests
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LotManifestRequest'
            examples:
              UpdateBatchNumber:
                value:
                  batch_number: PCM-2026-KE-UPDATED
                  expiry_date: '2028-11-15'
                  medicine: f9e8d7c6-b5a4-4321-9876-fedcba098765
                  distributor: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
                summary: Update Batch Number
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/LotManifestRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/LotManifestRequest'
        required: true
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LotManifest'
          description: ''
    patch:
      operationId: manifests_partial_update
      description: "\n        Partially update lot manifest with AUTOMATIC signature\
        \ regeneration.\n        \n        **Updatable Fields:**\n        - `batch_number`:\
        \ Lot/batch identifier\n        - `expiry_date`: Medicine expiration date\
        \  \n        - `medicine`: Medicine UUID\n        - `distributor`: Distributor\
        \ UUID\n        \n        **IMMUTABLE Fields:**\n        - `trust_score`:\
        \ Cannot be updated (ignored if provided)\n        - `digital_signature`:\
        \ Always auto-regenerated\n        \n        **Note:** Even partial updates\
        \ trigger signature regeneration!\n        \n        Requires admin role.\n\
        \        "
      summary: Partially update lot manifest
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Lot Manifest.
        required: true
      tags:
      - Manifests
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedLotManifestRequest'
            examples:
              UpdateOnlyBatchNumber:
                value:
                  batch_number: PCM-2026-KE-MODIFIED
                summary: Update Only Batch Number
              UpdateExpiryDate:
                value:
                  expiry_date: '2029-12-31'
                summary: Update Expiry Date
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/PatchedLotManifestRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/PatchedLotManifestRequest'
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LotManifest'
          description: ''
    delete:
      operationId: manifests_destroy
      description: Permanently delete a lot manifest from the system. Requires admin
        role.
      summary: Delete lot manifest
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Lot Manifest.
        required: true
      tags:
      - Manifests
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '204':
          description: No response body
  /api/manifests/{id}/verify/:
    post:
      operationId: manifests_verify_create
      description: "\n        Verify the Ed25519 digital signature of a lot manifest\
        \ using cryptographic verification.\n        \n        **SECURITY ARCHITECTURE:**\n\
        \        - The distributor signed this manifest OFF-SERVER using their Ed25519\
        \ private key\n        - The private key NEVER touches this server\n     \
        \   - We only use the distributor's PUBLIC KEY stored in the database\n  \
        \      - PyNaCl library performs Ed25519 elliptic curve cryptography verification\n\
        \        \n        **How It Works:**\n        1. Construct message: \"{batch_number}:{expiry_date}:{distributor_id}\"\
        \n        2. Retrieve distributor's Ed25519 public key from database\n   \
        \     3. Use PyNaCl to verify the signature cryptographically\n        4.\
        \ Return verification result with timestamp\n        \n        **No Request\
        \ Body Required** - Just POST to the endpoint.\n        \n        Returns\
        \ a structured JSON response with:\n        - **is_authentic**: Boolean -\
        \ True if cryptographically valid\n        - **trust_score**: Current trust\
        \ score from database\n        - **status**: \"Verified\" or \"Forged/Tampered\"\
        \n        - **timestamp**: Server time of verification (ISO 8601)\n      \
        \  "
      summary: Verify Ed25519 lot manifest signature
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Lot Manifest.
        required: true
      tags:
      - Manifests
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LotManifestRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/LotManifestRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/LotManifestRequest'
        required: true
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  is_authentic:
                    type: boolean
                  trust_score:
                    type: string
                  status:
                    type: string
                    enum:
                    - Verified
                    - Forged/Tampered
                  timestamp:
                    type: string
                    format: date-time
          description: Ed25519 signature verification result
        '404':
          description: Lot manifest not found
  /api/manifests/{id}/verify-qr/:
    get:
      operationId: manifests_verify_qr_retrieve
      description: "\n        Public endpoint for patients to verify medicine authenticity\
        \ via QR code.\n        \n        **Patient Workflow:**\n        1. Patient\
        \ scans QR code on medicine packet\n        2. Mobile app extracts lot_id\
        \ from QR code\n        3. App calls this endpoint (NO authentication required)\n\
        \        4. Patient sees medicine details and trust score\n        5. Patient\
        \ can raise flag if suspicious\n        \n        **Trust Score Status:**\n\
        \        - SAFE (80-100): Medicine is verified safe ✓\n        - CAUTION (60-79):\
        \ Some concerns reported ⚠️\n        - WARNING (0-59): Multiple issues, avoid\
        \ use ❌\n        \n        **Returns:**\n        - Medicine name, strength,\
        \ and details\n        - Distributor information\n        - Trust score with\
        \ color-coded status\n        - Signature verification status\n        - Expiry\
        \ date\n        - Count of unresolved quality flags\n        \n        **No\
        \ authentication required** - Public access for patient verification.\n  \
        \      "
      summary: Patient QR Code Verification (Public)
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Lot Manifest.
        required: true
      tags:
      - Patient Verification
      security:
      - jwtAuth: []
      - cookieAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  lot_id:
                    type: string
                    format: uuid
                  batch_number:
                    type: string
                  medicine:
                    type: object
                    properties:
                      name:
                        type: string
                      active_ingredient:
                        type: string
                      strength:
                        type: string
                      dosage_form:
                        type: string
                  distributor:
                    type: string
                  trust_score:
                    type: number
                  trust_status:
                    type: string
                    enum:
                    - SAFE
                    - CAUTION
                    - WARNING
                  is_authentic:
                    type: boolean
                  verification_message:
                    type: string
                  expiry_date:
                    type: string
                    format: date
                  flags_count:
                    type: integer
                  can_report:
                    type: boolean
                  report_url:
                    type: string
              examples:
                SafeMedicine:
                  value:
                    lot_id: 494466b3-0f94-4f5c-8a12-38e403fcf3e7
                    batch_number: BATCH-2024-PCM-001
                    medicine:
                      name: Paracetamol Tablets
                      active_ingredient: Paracetamol
                      strength: 500mg
                      dosage_form: Tablet
                    distributor: HealthDist Kenya Ltd
                    expiry_date: '2028-11-15'
                    trust_score: 95.0
                    trust_status: SAFE
                    is_authentic: true
                    verification_message: Verified
                    flags_count: 0
                    can_report: true
                    report_url: /api/flags/
                  summary: Safe Medicine
          description: Patient-friendly verification response
        '404':
          description: Lot manifest not found
  /api/medicines/:
    get:
      operationId: medicines_list
      description: "\n        Retrieve a paginated list of pharmaceutical medicines\
        \ with detailed information.\n        \n        Supports filtering by:\n \
        \       - Category (e.g., Antibiotic, Antimalarial)\n        - Distributor\
        \ ID\n        - Search by name, active ingredient, or manufacturer\n     \
        \   "
      summary: List all medicines
      parameters:
      - in: query
        name: category
        schema:
          type: string
        description: Filter by medicine category (case-insensitive)
        examples:
          Antibiotic:
            value: Antibiotic
          Antimalarial:
            value: Antimalarial
      - in: query
        name: distributor
        schema:
          type: string
          format: uuid
        description: Filter by distributor UUID
      - name: ordering
        required: false
        in: query
        description: Which field to use when ordering the results.
        schema:
          type: string
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      - in: query
        name: search
        schema:
          type: string
        description: Search by name, active ingredient, or manufacturer
      tags:
      - Medicines
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedMedicineList'
          description: ''
    post:
      operationId: medicines_create
      description: "\n        Add a new pharmaceutical medicine to the catalog.\n\
        \        \n        **Required fields:**\n        - name: Product name\n  \
        \      - active_ingredient: Generic/API name\n        - strength: Drug strength\
        \ (e.g., 500mg)\n        - dosage_form: Form (Tablet, Capsule, Syrup, etc.)\n\
        \        - manufacturer_name: Manufacturing company\n        - distributor:\
        \ Distributor UUID\n        \n        **Requires admin role.**\n        "
      summary: Create new medicine
      tags:
      - Medicines
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MedicineRequest'
            examples:
              ParacetamolTablet:
                value:
                  name: Paracetamol Tablets
                  active_ingredient: Paracetamol
                  strength: 500mg
                  dosage_form: Tablet
                  manufacturer_name: Universal Corporation Ltd
                  category: Analgesic
                  distributor: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
                summary: Paracetamol Tablet
              AmoxicillinCapsule:
                value:
                  name: Amoxicillin Capsules
                  active_ingredient: Amoxicillin
                  strength: 250mg
                  dosage_form: Capsule
                  manufacturer_name: PharmaCorp Kenya
                  category: Antibiotic
                  distributor: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
                summary: Amoxicillin Capsule
              ArtemetherCombination:
                value:
                  name: Coartem Tablets
                  active_ingredient: Artemether + Lumefantrine
                  strength: 20mg/120mg
                  dosage_form: Tablet
                  manufacturer_name: Novartis East Africa
                  category: Antimalarial
                  distributor: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
                summary: Artemether Combination
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/MedicineRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/MedicineRequest'
        required: true
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Medicine'
          description: ''
  /api/medicines/{id}/:
    get:
      operationId: medicines_retrieve
      description: "\n        Get detailed information about a specific medicine including:\n\
        \        - Product name and active ingredient\n        - Strength and dosage\
        \ form\n        - Manufacturer details\n        - Distributor information\n\
        \        "
      summary: Retrieve medicine details
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Medicine.
        required: true
      tags:
      - Medicines
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Medicine'
          description: ''
    put:
      operationId: medicines_update
      description: "\n        Update all fields of an existing medicine.\n       \
        \ \n        All fields must be provided (use PATCH for partial updates).\n\
        \        Requires admin role.\n        "
      summary: Update medicine
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Medicine.
        required: true
      tags:
      - Medicines
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MedicineRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/MedicineRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/MedicineRequest'
        required: true
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Medicine'
          description: ''
    patch:
      operationId: medicines_partial_update
      description: "\n        Update specific fields of a medicine without providing\
        \ all fields.\n        \n        Useful for updating just the strength, manufacturer,\
        \ or other specific attributes.\n        Requires admin role.\n        "
      summary: Partially update medicine
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Medicine.
        required: true
      tags:
      - Medicines
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedMedicineRequest'
            examples:
              UpdateStrength:
                value:
                  strength: 1000mg
                summary: Update Strength
              UpdateManufacturer:
                value:
                  manufacturer_name: GlaxoSmithKline Kenya
                summary: Update Manufacturer
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/PatchedMedicineRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/PatchedMedicineRequest'
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Medicine'
          description: ''
    delete:
      operationId: medicines_destroy
      description: "\n        Permanently delete a medicine from the catalog.\n  \
        \      \n        **Warning:** This will also affect any lot manifests referencing\
        \ this medicine.\n        Requires admin role.\n        "
      summary: Delete medicine
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Medicine.
        required: true
      tags:
      - Medicines
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '204':
          description: No response body
  /api/receipts/:
    get:
      operationId: receipts_list
      description: Retrieve a paginated list of receipt events with filtering by user,
        lot, or date range.
      summary: List all receipt events
      parameters:
      - in: query
        name: date_from
        schema:
          type: string
          format: date
        description: Filter events from this date onwards (YYYY-MM-DD)
        examples:
          StartOfYear:
            value: '2026-01-01'
            summary: Start of Year
      - in: query
        name: date_to
        schema:
          type: string
          format: date
        description: Filter events up to this date (YYYY-MM-DD)
        examples:
          EndOfMonth:
            value: '2026-01-31'
            summary: End of Month
      - in: query
        name: lot
        schema:
          type: string
          format: uuid
        description: Filter by lot manifest ID
      - name: ordering
        required: false
        in: query
        description: Which field to use when ordering the results.
        schema:
          type: string
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      - name: search
        required: false
        in: query
        description: A search term.
        schema:
          type: string
      - in: query
        name: user
        schema:
          type: string
          format: uuid
        description: Filter by user (pharmacist) ID
      tags:
      - Receipts
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedReceiptEventList'
          description: ''
    post:
      operationId: receipts_create
      description: "\n        Record a new receipt event when a pharmacist receives\
        \ a pharmaceutical lot.\n        \n        **Auto-Populated Fields:**\n  \
        \      - `user`: Automatically set to authenticated pharmacist (DO NOT include\
        \ this field!)\n        - `created_at`: Auto-timestamp\n        \n       \
        \ **Location Format:**\n        - Provide GPS coordinates as JSON: {\"lat\"\
        : latitude, \"lng\": longitude}\n        - Latitude: -90 to 90 (negative =\
        \ South)\n        - Longitude: -180 to 180 (negative = West)\n        \n \
        \       **Immutability:**\n        Receipt events are audit logs and CANNOT\
        \ be updated or deleted after creation.\n        \n        **Pharmacist-only\
        \ access.**\n        "
      summary: Create new receipt event
      tags:
      - Receipts
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReceiptEventRequest'
            examples:
              ReceiptAtNairobiPharmacy:
                value:
                  location_coord:
                    lat: -1.2921
                    lng: 36.8219
                  lot: 494466b3-0f94-4f5c-8a12-38e403fcf3e7
                summary: Receipt at Nairobi Pharmacy
              ReceiptAtMombasaPharmacy:
                value:
                  location_coord:
                    lat: -4.0435
                    lng: 39.6682
                  lot: a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d
                summary: Receipt at Mombasa Pharmacy
              ReceiptAtKisumuPharmacy:
                value:
                  location_coord:
                    lat: -0.0917
                    lng: 34.768
                  lot: f9e8d7c6-b5a4-4321-9876-fedcba098765
                summary: Receipt at Kisumu Pharmacy
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/ReceiptEventRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ReceiptEventRequest'
        required: true
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReceiptEvent'
          description: ''
  /api/receipts/{id}/:
    get:
      operationId: receipts_retrieve
      description: Get detailed information about a specific receipt event including
        location coordinates and lot details.
      summary: Retrieve receipt event details
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this Receipt Event.
        required: true
      tags:
      - Receipts
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReceiptEvent'
          description: ''
  /api/users/:
    get:
      operationId: users_list
      description: Retrieve a paginated list of all registered users with optional
        role filtering.
      summary: List all users
      parameters:
      - name: ordering
        required: false
        in: query
        description: Which field to use when ordering the results.
        schema:
          type: string
      - name: page
        required: false
        in: query
        description: A page number within the paginated result set.
        schema:
          type: integer
      - in: query
        name: role
        schema:
          type: string
        description: Filter users by role
        examples:
          PharmacistsOnly:
            value: PHARMACIST
            summary: Pharmacists Only
          PatientsOnly:
            value: PATIENT
            summary: Patients Only
          RegulatorsOnly:
            value: REGULATOR
            summary: Regulators Only
      - name: search
        required: false
        in: query
        description: A search term.
        schema:
          type: string
      tags:
      - Users
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedUserList'
          description: ''
    post:
      operationId: users_create
      description: "\n        Register a new user account with role-based access.\n\
        \        \n        **Available Roles:**\n        - PATIENT: Can view products,\
        \ create quality flags\n        - PHARMACIST: Can receive lots, create flags,\
        \ view receipt events\n        - REGULATOR: Full read access (future use)\n\
        \        \n        **Public endpoint** - No authentication required for registration.\n\
        \        "
      summary: Create new user
      tags:
      - Users
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRequest'
            examples:
              PharmacistRegistration:
                value:
                  username: pharmacist1
                  email: pharmacist@example.com
                  password: SecurePass123!
                  role: PHARMACIST
                summary: Pharmacist Registration
              PatientRegistration:
                value:
                  username: patient1
                  email: patient@example.com
                  password: SecurePass123!
                  role: PATIENT
                summary: Patient Registration
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/UserRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/UserRequest'
        required: true
      security:
      - jwtAuth: []
      - cookieAuth: []
      - {}
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: ''
  /api/users/{id}/:
    get:
      operationId: users_retrieve
      description: Get detailed information about a specific user including role and
        contact information.
      summary: Retrieve user details
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User.
        required: true
      tags:
      - Users
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: ''
    put:
      operationId: users_update
      description: Update all fields of an existing user account.
      summary: Update user
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User.
        required: true
      tags:
      - Users
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/UserRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/UserRequest'
        required: true
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: ''
    patch:
      operationId: users_partial_update
      description: Update specific fields of an existing user account.
      summary: Partially update user
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User.
        required: true
      tags:
      - Users
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedUserRequest'
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/PatchedUserRequest'
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/PatchedUserRequest'
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: ''
    delete:
      operationId: users_destroy
      description: Permanently delete a user account from the system.
      summary: Delete user
      parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        description: A UUID string identifying this User.
        required: true
      tags:
      - Users
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '204':
          description: No response body
  /api/users/me/:
    get:
      operationId: users_me_retrieve
      description: "\n        Retrieve the profile information of the currently authenticated\
        \ user.\n        \n        Useful for:\n        - Displaying user info in\
        \ the app\n        - Checking current user's role\n        - Getting user\
        \ ID for other operations\n        "
      summary: Get current user profile
      tags:
      - Users
      security:
      - jwtAuth: []
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
          description: ''
components:
  schemas:
    CrowdFlag:
      type: object
      description: Serializer for the CrowdFlag model.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        reporter_type:
          type: string
          description: Type of reporter (e.g., Pharmacist, Patient, Healthcare Worker)
          maxLength: 50
        issue_type:
          type: string
          description: Type of issue reported (e.g., Counterfeit Suspected, Quality
            Issue, Packaging Damage)
          maxLength: 100
        severity:
          allOf:
          - $ref: '#/components/schemas/SeverityEnum'
          description: |-
            Severity level of the reported issue (impacts trust score calculation)

            * `CRITICAL` - Critical - Immediate safety concern
            * `HIGH` - High - Significant quality issue
            * `MEDIUM` - Medium - Notable concern
            * `LOW` - Low - Minor issue
        description:
          type: string
          description: Detailed description of the issue
        user:
          type: string
          format: uuid
          readOnly: true
          description: User who reported the issue
        user_username:
          type: string
          readOnly: true
        lot:
          type: string
          format: uuid
          description: Lot manifest being flagged
        lot_batch_number:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
        is_resolved:
          type: boolean
      required:
      - created_at
      - description
      - id
      - issue_type
      - lot
      - lot_batch_number
      - reporter_type
      - user
      - user_username
    CrowdFlagRequest:
      type: object
      description: Serializer for the CrowdFlag model.
      properties:
        reporter_type:
          type: string
          minLength: 1
          description: Type of reporter (e.g., Pharmacist, Patient, Healthcare Worker)
          maxLength: 50
        issue_type:
          type: string
          minLength: 1
          description: Type of issue reported (e.g., Counterfeit Suspected, Quality
            Issue, Packaging Damage)
          maxLength: 100
        severity:
          allOf:
          - $ref: '#/components/schemas/SeverityEnum'
          description: |-
            Severity level of the reported issue (impacts trust score calculation)

            * `CRITICAL` - Critical - Immediate safety concern
            * `HIGH` - High - Significant quality issue
            * `MEDIUM` - Medium - Notable concern
            * `LOW` - Low - Minor issue
        description:
          type: string
          minLength: 1
          description: Detailed description of the issue
        lot:
          type: string
          format: uuid
          description: Lot manifest being flagged
        is_resolved:
          type: boolean
      required:
      - description
      - issue_type
      - lot
      - reporter_type
    Distributor:
      type: object
      description: |-
        Serializer for the Distributor model with automatic Ed25519 key generation.

        When creating a distributor without providing a public_key, the serializer will:
        1. Generate an Ed25519 key pair
        2. Store the public key in the database
        3. Return the private key in the response (for secure distribution to the vendor)

        The private_key is write-only and only appears in the creation response.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        name:
          type: string
          maxLength: 255
        public_key:
          type: string
          readOnly: true
          description: Public key for verifying digital signatures
        private_key:
          type: string
          readOnly: true
          description: Ed25519 private key (hex) - Only returned on creation. Save
            this securely!
        is_verified_regulator:
          type: boolean
          description: Whether this distributor is verified by regulatory authorities
      required:
      - id
      - name
      - private_key
      - public_key
    DistributorRequest:
      type: object
      description: |-
        Serializer for the Distributor model with automatic Ed25519 key generation.

        When creating a distributor without providing a public_key, the serializer will:
        1. Generate an Ed25519 key pair
        2. Store the public key in the database
        3. Return the private key in the response (for secure distribution to the vendor)

        The private_key is write-only and only appears in the creation response.
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 255
        is_verified_regulator:
          type: boolean
          description: Whether this distributor is verified by regulatory authorities
      required:
      - name
    LotManifest:
      type: object
      description: |-
        Serializer for LotManifest with AUTO-GENERATED Ed25519 signatures.

        UPDATABLE FIELDS:
        - batch_number: Lot/batch identifier
        - expiry_date: Medicine expiration date
        - medicine: Medicine ID
        - distributor: Distributor ID

        IMMUTABLE FIELDS (Auto-Managed):
        - digital_signature: ALWAYS auto-regenerated on create/update
        - trust_score: IMMUTABLE - cannot be changed after creation
        - is_authentic: Computed field (verification result)

        SECURITY:
        - Ed25519 signatures auto-generated using derived keys
        - No private keys stored in database
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        batch_number:
          type: string
          maxLength: 100
        expiry_date:
          type: string
          format: date
        digital_signature:
          type: string
          readOnly: true
          description: Auto-generated Ed25519 digital signature (128 hex chars)
        trust_score:
          type: string
          format: decimal
          pattern: ^-?\d{0,3}(?:\.\d{0,2})?$
          readOnly: true
          description: Trust score based on verification (0.00 to 100.00)
        medicine:
          type: string
          format: uuid
          description: Medicine associated with this lot
        medicine_name:
          type: string
          readOnly: true
        distributor:
          type: string
          format: uuid
          description: Distributor who provided this lot
        distributor_name:
          type: string
          readOnly: true
        is_authentic:
          type: string
          readOnly: true
          description: Boolean result of signature verification
      required:
      - batch_number
      - digital_signature
      - distributor
      - distributor_name
      - expiry_date
      - id
      - is_authentic
      - medicine
      - medicine_name
      - trust_score
    LotManifestRequest:
      type: object
      description: |-
        Serializer for LotManifest with AUTO-GENERATED Ed25519 signatures.

        UPDATABLE FIELDS:
        - batch_number: Lot/batch identifier
        - expiry_date: Medicine expiration date
        - medicine: Medicine ID
        - distributor: Distributor ID

        IMMUTABLE FIELDS (Auto-Managed):
        - digital_signature: ALWAYS auto-regenerated on create/update
        - trust_score: IMMUTABLE - cannot be changed after creation
        - is_authentic: Computed field (verification result)

        SECURITY:
        - Ed25519 signatures auto-generated using derived keys
        - No private keys stored in database
      properties:
        batch_number:
          type: string
          minLength: 1
          maxLength: 100
        expiry_date:
          type: string
          format: date
        medicine:
          type: string
          format: uuid
          description: Medicine associated with this lot
        distributor:
          type: string
          format: uuid
          description: Distributor who provided this lot
      required:
      - batch_number
      - distributor
      - expiry_date
      - medicine
    Medicine:
      type: object
      description: Serializer for the Medicine model with detailed pharmaceutical
        information.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        name:
          type: string
          description: Product name
          maxLength: 255
        category:
          type: string
          description: Medicine category (e.g., Antibiotic, Analgesic)
          maxLength: 100
        active_ingredient:
          type: string
          description: Active pharmaceutical ingredient (API) or generic name
          maxLength: 255
        strength:
          type: string
          description: Drug strength (e.g., 500mg, 250mg/5ml)
          maxLength: 100
        dosage_form:
          type: string
          description: Form of medication (e.g., Tablet, Capsule, Syrup, Injection)
          maxLength: 100
        manufacturer_name:
          type: string
          description: Name of the manufacturing company
          maxLength: 255
        distributor:
          type: string
          format: uuid
          description: Distributor responsible for this medicine
        distributor_name:
          type: string
          readOnly: true
      required:
      - distributor
      - distributor_name
      - id
      - name
    MedicineRequest:
      type: object
      description: Serializer for the Medicine model with detailed pharmaceutical
        information.
      properties:
        name:
          type: string
          minLength: 1
          description: Product name
          maxLength: 255
        category:
          type: string
          description: Medicine category (e.g., Antibiotic, Analgesic)
          maxLength: 100
        active_ingredient:
          type: string
          description: Active pharmaceutical ingredient (API) or generic name
          maxLength: 255
        strength:
          type: string
          description: Drug strength (e.g., 500mg, 250mg/5ml)
          maxLength: 100
        dosage_form:
          type: string
          description: Form of medication (e.g., Tablet, Capsule, Syrup, Injection)
          maxLength: 100
        manufacturer_name:
          type: string
          description: Name of the manufacturing company
          maxLength: 255
        distributor:
          type: string
          format: uuid
          description: Distributor responsible for this medicine
      required:
      - distributor
      - name
    PaginatedCrowdFlagList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/CrowdFlag'
    PaginatedDistributorList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/Distributor'
    PaginatedLotManifestList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/LotManifest'
    PaginatedMedicineList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/Medicine'
    PaginatedReceiptEventList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/ReceiptEvent'
    PaginatedUserList:
      type: object
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/User'
    PatchedCrowdFlagRequest:
      type: object
      description: Serializer for the CrowdFlag model.
      properties:
        reporter_type:
          type: string
          minLength: 1
          description: Type of reporter (e.g., Pharmacist, Patient, Healthcare Worker)
          maxLength: 50
        issue_type:
          type: string
          minLength: 1
          description: Type of issue reported (e.g., Counterfeit Suspected, Quality
            Issue, Packaging Damage)
          maxLength: 100
        severity:
          allOf:
          - $ref: '#/components/schemas/SeverityEnum'
          description: |-
            Severity level of the reported issue (impacts trust score calculation)

            * `CRITICAL` - Critical - Immediate safety concern
            * `HIGH` - High - Significant quality issue
            * `MEDIUM` - Medium - Notable concern
            * `LOW` - Low - Minor issue
        description:
          type: string
          minLength: 1
          description: Detailed description of the issue
        lot:
          type: string
          format: uuid
          description: Lot manifest being flagged
        is_resolved:
          type: boolean
    PatchedDistributorRequest:
      type: object
      description: |-
        Serializer for the Distributor model with automatic Ed25519 key generation.

        When creating a distributor without providing a public_key, the serializer will:
        1. Generate an Ed25519 key pair
        2. Store the public key in the database
        3. Return the private key in the response (for secure distribution to the vendor)

        The private_key is write-only and only appears in the creation response.
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 255
        is_verified_regulator:
          type: boolean
          description: Whether this distributor is verified by regulatory authorities
    PatchedLotManifestRequest:
      type: object
      description: |-
        Serializer for LotManifest with AUTO-GENERATED Ed25519 signatures.

        UPDATABLE FIELDS:
        - batch_number: Lot/batch identifier
        - expiry_date: Medicine expiration date
        - medicine: Medicine ID
        - distributor: Distributor ID

        IMMUTABLE FIELDS (Auto-Managed):
        - digital_signature: ALWAYS auto-regenerated on create/update
        - trust_score: IMMUTABLE - cannot be changed after creation
        - is_authentic: Computed field (verification result)

        SECURITY:
        - Ed25519 signatures auto-generated using derived keys
        - No private keys stored in database
      properties:
        batch_number:
          type: string
          minLength: 1
          maxLength: 100
        expiry_date:
          type: string
          format: date
        medicine:
          type: string
          format: uuid
          description: Medicine associated with this lot
        distributor:
          type: string
          format: uuid
          description: Distributor who provided this lot
    PatchedMedicineRequest:
      type: object
      description: Serializer for the Medicine model with detailed pharmaceutical
        information.
      properties:
        name:
          type: string
          minLength: 1
          description: Product name
          maxLength: 255
        category:
          type: string
          description: Medicine category (e.g., Antibiotic, Analgesic)
          maxLength: 100
        active_ingredient:
          type: string
          description: Active pharmaceutical ingredient (API) or generic name
          maxLength: 255
        strength:
          type: string
          description: Drug strength (e.g., 500mg, 250mg/5ml)
          maxLength: 100
        dosage_form:
          type: string
          description: Form of medication (e.g., Tablet, Capsule, Syrup, Injection)
          maxLength: 100
        manufacturer_name:
          type: string
          description: Name of the manufacturing company
          maxLength: 255
        distributor:
          type: string
          format: uuid
          description: Distributor responsible for this medicine
    PatchedUserRequest:
      type: object
      description: |-
        Serializer for the User model with password handling.

        Includes password and password2 fields for registration/updates.
        Passwords are write-only and properly hashed using set_password().
      properties:
        username:
          type: string
          minLength: 1
          description: Required. 150 characters or fewer. Letters, digits and @/./+/-/_
            only.
          pattern: ^[\w.@+-]+$
          maxLength: 150
        email:
          type: string
          format: email
          title: Email address
          maxLength: 254
        password:
          type: string
          writeOnly: true
          minLength: 8
          description: User password (min 8 characters)
        password2:
          type: string
          writeOnly: true
          minLength: 1
          description: Password confirmation
        role:
          $ref: '#/components/schemas/RoleEnum'
        first_name:
          type: string
          maxLength: 150
        last_name:
          type: string
          maxLength: 150
        is_active:
          type: boolean
          title: Active
          description: Designates whether this user should be treated as active. Unselect
            this instead of deleting accounts.
    ReceiptEvent:
      type: object
      description: Serializer for the ReceiptEvent model.
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        location_coord:
          description: 'Geographic coordinates in JSON format (e.g., {''lat'': 40.7128,
            ''lng'': -74.0060})'
        user:
          type: string
          format: uuid
          readOnly: true
          description: User who scanned/received the lot
        user_username:
          type: string
          readOnly: true
        lot:
          type: string
          format: uuid
          description: Lot manifest that was scanned/received
        lot_batch_number:
          type: string
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
      required:
      - created_at
      - id
      - location_coord
      - lot
      - lot_batch_number
      - user
      - user_username
    ReceiptEventRequest:
      type: object
      description: Serializer for the ReceiptEvent model.
      properties:
        location_coord:
          description: 'Geographic coordinates in JSON format (e.g., {''lat'': 40.7128,
            ''lng'': -74.0060})'
        lot:
          type: string
          format: uuid
          description: Lot manifest that was scanned/received
      required:
      - location_coord
      - lot
    RoleEnum:
      enum:
      - Admin
      - Pharmacist
      - Patient
      type: string
      description: |-
        * `Admin` - Admin
        * `Pharmacist` - Pharmacist
        * `Patient` - Patient
    SeverityEnum:
      enum:
      - CRITICAL
      - HIGH
      - MEDIUM
      - LOW
      type: string
      description: |-
        * `CRITICAL` - Critical - Immediate safety concern
        * `HIGH` - High - Significant quality issue
        * `MEDIUM` - Medium - Notable concern
        * `LOW` - Low - Minor issue
    TokenObtainPair:
      type: object
      properties:
        access:
          type: string
          readOnly: true
        refresh:
          type: string
          readOnly: true
      required:
      - access
      - refresh
    TokenObtainPairRequest:
      type: object
      properties:
        username:
          type: string
          writeOnly: true
          minLength: 1
        password:
          type: string
          writeOnly: true
          minLength: 1
      required:
      - password
      - username
    TokenRefresh:
      type: object
      properties:
        access:
          type: string
          readOnly: true
        refresh:
          type: string
      required:
      - access
      - refresh
    TokenRefreshRequest:
      type: object
      properties:
        refresh:
          type: string
          minLength: 1
      required:
      - refresh
    User:
      type: object
      description: |-
        Serializer for the User model with password handling.

        Includes password and password2 fields for registration/updates.
        Passwords are write-only and properly hashed using set_password().
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        username:
          type: string
          description: Required. 150 characters or fewer. Letters, digits and @/./+/-/_
            only.
          pattern: ^[\w.@+-]+$
          maxLength: 150
        email:
          type: string
          format: email
          title: Email address
          maxLength: 254
        role:
          $ref: '#/components/schemas/RoleEnum'
        first_name:
          type: string
          maxLength: 150
        last_name:
          type: string
          maxLength: 150
        date_joined:
          type: string
          format: date-time
          readOnly: true
        is_active:
          type: boolean
          title: Active
          description: Designates whether this user should be treated as active. Unselect
            this instead of deleting accounts.
      required:
      - date_joined
      - id
      - username
    UserRequest:
      type: object
      description: |-
        Serializer for the User model with password handling.

        Includes password and password2 fields for registration/updates.
        Passwords are write-only and properly hashed using set_password().
      properties:
        username:
          type: string
          minLength: 1
          description: Required. 150 characters or fewer. Letters, digits and @/./+/-/_
            only.
          pattern: ^[\w.@+-]+$
          maxLength: 150
        email:
          type: string
          format: email
          title: Email address
          maxLength: 254
        password:
          type: string
          writeOnly: true
          minLength: 8
          description: User password (min 8 characters)
        password2:
          type: string
          writeOnly: true
          minLength: 1
          description: Password confirmation
        role:
          $ref: '#/components/schemas/RoleEnum'
        first_name:
          type: string
          maxLength: 150
        last_name:
          type: string
          maxLength: 150
        is_active:
          type: boolean
          title: Active
          description: Designates whether this user should be treated as active. Unselect
            this instead of deleting accounts.
      required:
      - password
      - password2
      - username
  securitySchemes:
    cookieAuth:
      type: apiKey
      in: cookie
      name: sessionid
    jwtAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
tags:
- name: Authentication
  description: JWT token management
- name: Users
  description: User account management
- name: Distributors
  description: Pharmaceutical distributor management
- name: Medicines
  description: Medicine catalog operations
- name: Manifests
  description: Lot manifest and signature verification
- name: Receipts
  description: Receipt event tracking
- name: Flags
  description: Crowdsourced quality reports
